{"version":3,"sources":["product-finder.js"],"names":["$","setupProductFinderSlider","parentElement","slidesToShow","context","slidesMedium","slidesLarge","stretchFewer","parent","count","children","length","responsive","push","breakpoint","settings","slidesToScroll","slick","dots","arrows","adaptiveHeight","mobileFirst","on","event","switchToFirstActiveSlide","setupProductFilterClickHandler","each","filterContainer","this","productFinderView","siblings","eq","exposedForm","find","exposedSubmit","exposedFilter","selectedFilter","val","allItems","preventDefault","filterItem","filterLink","filterId","attr","trigger","not","removeClass","addClass","has","slider","firstActive","first","index","setupAjaxCompleteHandler","ajaxComplete","xhr","data","indexOf","filteredRows","unfilteredRows","firstValidResult","row","productId","className","match","isActive","toggleClass","Drupal","behaviors","productFinder","attach","oneSidebar","hasClass","twoSidebars","jQuery"],"mappings":"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","file":"../product-finder.js","sourcesContent":["(function ($) {\n  'use strict';\n\n  function setupProductFinderSlider(parentElement, slidesToShow, context, slidesMedium, slidesLarge, stretchFewer) {\n    slidesMedium = slidesMedium || false;\n    slidesLarge = slidesLarge || false;\n    stretchFewer = stretchFewer || false;\n\n    var parent = $(parentElement, context);\n\n    if (stretchFewer) {\n      var count = parent.children().length;\n\n      if (slidesToShow > count) {\n        slidesToShow = count;\n      }\n\n      if (slidesMedium && slidesMedium > count) {\n        slidesMedium = count;\n      }\n\n      if (slidesLarge && slidesLarge > count) {\n        slidesLarge = count;\n      }\n    }\n\n    var responsive = [];\n\n    if (slidesMedium) {\n      responsive.push({\n        breakpoint: 600,\n        settings: {\n          slidesToShow: slidesMedium,\n          slidesToScroll: slidesMedium\n        }\n      });\n    }\n\n    if (slidesLarge) {\n      responsive.push({\n        breakpoint: 900,\n        settings: {\n          slidesToShow: slidesLarge,\n          slidesToScroll: slidesLarge\n        }\n      });\n    }\n\n    var slick = parent.slick({\n      slidesToShow: slidesToShow,\n      slidesToScroll: slidesToShow,\n      dots: false,\n      arrows: true,\n      adaptiveHeight: true,\n      mobileFirst: true,\n      responsive: responsive\n    });\n\n    parent.on('breakpoint', function (event, slick, breakpoint) {\n      switchToFirstActiveSlide(slick);\n    });\n\n    return slick;\n  }\n\n  function setupProductFilterClickHandler(context) {\n    $('.product-finder-applications-filter', context).each(function () {\n      var filterContainer = $(this);\n      var productFinderView = filterContainer.siblings('.product-finder-filtered-view').eq(0);\n      var exposedForm = productFinderView.find('.views-exposed-form').eq(0);\n      var exposedSubmit = exposedForm.find('.form-submit').eq(0);\n      var exposedFilter = exposedForm.find('.FormItem--field-applications-target-id .form-select').eq(0);\n      var selectedFilter = exposedFilter.val();\n      var allItems = filterContainer.find('.product-finder-applications-filter-item');\n\n      filterContainer.on('click', '.product-finder-applications-filter-item', function (event) {\n        event.preventDefault();\n        var filterItem = $(this);\n        var filterLink = filterItem.find('.product-finder-application-filter-item-link').eq(0);\n        var filterId = filterLink.attr('data-filter-id');\n\n        productFinderView = filterContainer.siblings('.product-finder-filtered-view').eq(0);\n        exposedForm = productFinderView.find('.views-exposed-form').eq(0);\n        exposedSubmit = exposedForm.find('.form-submit').eq(0);\n        exposedFilter = exposedForm.find('.FormItem--field-applications-target-id .form-select').eq(0);\n\n        exposedFilter.val(filterId);\n        exposedSubmit.trigger('click');\n        allItems.not(filterItem).removeClass('is-active');\n        filterItem.addClass('is-active');\n      });\n\n      if (selectedFilter !== 'All') {\n        allItems.has('[data-filter-id=\"' + selectedFilter + '\"]').addClass('is-active');\n      }\n    });\n  }\n\n  function switchToFirstActiveSlide(slider) {\n    var firstActive = $('.slick-slide', slider).not('.is-deactivated').first();\n    var index = firstActive.attr('data-slick-index');\n    var currentSlideIndex = $(slider).slick('slickCurrentSlide');\n\n    if (currentSlideIndex !== index) {\n      $(slider).slick('slickGoTo', index);\n    }\n  }\n\n  function setupAjaxCompleteHandler(context) {\n    $(context).ajaxComplete(function(event, xhr, settings) {\n      if (settings.data && settings.data.indexOf('field_applications_target_id') === 0) {\n        var filteredRows = $('.product-finder-filtered-view .view-content .views-row', context);\n        var slider = $('.view-product-finder-unfiltered .view-content');\n        var unfilteredRows = slider.find('.views-row');\n        var firstValidResult = null;\n\n        unfilteredRows.each(function () {\n          var row = $(this);\n          var productId = $(this).find('.CommerceProduct')[0].className.match(/CommerceProduct--id-(\\d+)/)[1];\n          var isActive = ($(filteredRows).find('.CommerceProduct--id-' + productId).length > 0);\n\n          row.toggleClass('is-deactivated', !isActive);\n\n          if (isActive && !firstValidResult) {\n            firstValidResult = row;\n          }\n        });\n\n        switchToFirstActiveSlide(slider);\n      }\n    });\n  }\n\n  Drupal.behaviors.productFinder = {\n    attach: function (context, settings) {\n      var oneSidebar = $('body').hasClass('one-sidebar');\n      var twoSidebars = $('body').hasClass('two-sidebars')\n\n      var slidesSmall = 1;\n      var slidesMedium = 2;\n      var slidesLarge = 4;\n\n      if (oneSidebar) {\n        slidesLarge = 3;\n      } else if (twoSidebars) {\n        slidesLarge = 2;\n      }\n\n      setupProductFinderSlider('.view-product-finder-unfiltered .view-content', slidesSmall, context, slidesMedium, slidesLarge);\n      setupProductFilterClickHandler(context);\n      setupAjaxCompleteHandler(context);\n    }\n  };\n}(jQuery));\n"]}